"use strict";(globalThis.webpackChunkattentionmarket_docs=globalThis.webpackChunkattentionmarket_docs||[]).push([[1660],{1991(e,n,t){t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>p,frontMatter:()=>o,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"mobile-integration","title":"Mobile Integration Guide","description":"Complete guide for integrating AttentionMarket into iOS and Android applications. Native SDKs coming Q2 2024 - use our REST API until then.","source":"@site/docs/mobile-integration.md","sourceDirName":".","slug":"/mobile-integration","permalink":"/agent-ads-sdk/docs/mobile-integration","draft":false,"unlisted":false,"editUrl":"https://github.com/rtrivedi/agent-ads-sdk/tree/main/attentionmarket-docs/docs/mobile-integration.md","tags":[],"version":"current","lastUpdatedBy":"Ronak Trivedi","lastUpdatedAt":1772323214000,"sidebarPosition":10,"frontMatter":{"sidebar_position":10,"title":"Mobile Integration Guide"},"sidebar":"tutorialSidebar","previous":{"title":"REST API Reference","permalink":"/agent-ads-sdk/docs/api-reference"},"next":{"title":"Context-Aware Matching","permalink":"/agent-ads-sdk/docs/smart-context"}}');var a=t(4848),r=t(8453);const o={sidebar_position:10,title:"Mobile Integration Guide"},s="Mobile Integration Guide",l={},d=[{value:"iOS Integration (Swift)",id:"ios-integration-swift",level:2},{value:"Installation",id:"installation",level:3},{value:"SwiftUI Ad Component",id:"swiftui-ad-component",level:3},{value:"UIKit Ad Component",id:"uikit-ad-component",level:3},{value:"Integration in Chat View",id:"integration-in-chat-view",level:3},{value:"Android Integration (Kotlin)",id:"android-integration-kotlin",level:2},{value:"Installation",id:"installation-1",level:3},{value:"Jetpack Compose Ad Component",id:"jetpack-compose-ad-component",level:3},{value:"Contextual Placement Strategy",id:"contextual-placement-strategy",level:2},{value:"Smart Placement Rules",id:"smart-placement-rules",level:3},{value:"Performance &amp; Optimization",id:"performance--optimization",level:2},{value:"Caching Strategy",id:"caching-strategy",level:3},{value:"Battery &amp; Data Optimization",id:"battery--data-optimization",level:3},{value:"App Store &amp; Play Store Compliance",id:"app-store--play-store-compliance",level:2},{value:"Required Disclosures",id:"required-disclosures",level:3},{value:"Testing",id:"testing",level:2},{value:"Test Credentials",id:"test-credentials",level:3},{value:"Test Scenarios",id:"test-scenarios",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Common Issues",id:"common-issues",level:3},{value:"Support",id:"support",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"mobile-integration-guide",children:"Mobile Integration Guide"})}),"\n",(0,a.jsx)(n.p,{children:"Complete guide for integrating AttentionMarket into iOS and Android applications. Native SDKs coming Q2 2024 - use our REST API until then."}),"\n",(0,a.jsx)(n.h2,{id:"ios-integration-swift",children:"iOS Integration (Swift)"}),"\n",(0,a.jsx)(n.h3,{id:"installation",children:"Installation"}),"\n",(0,a.jsx)(n.p,{children:"Create a Swift package or add these files to your project:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",metastring:'title="AttentionMarketClient.swift"',children:'import Foundation\n\nclass AttentionMarketClient {\n    private let apiKey: String\n    private let agentId: String\n    private let baseURL = "https://api.attentionmarket.ai/v1"\n    private let session: URLSession\n\n    init(apiKey: String, agentId: String) {\n        self.apiKey = apiKey\n        self.agentId = agentId\n\n        // Configure session with caching\n        let config = URLSessionConfiguration.default\n        config.requestCachePolicy = .returnCacheDataElseLoad\n        config.timeoutIntervalForRequest = 10\n        self.session = URLSession(configuration: config)\n    }\n\n    func getAd(\n        userMessage: String,\n        conversationHistory: [String]? = nil,\n        placement: String = "sponsored_suggestion"\n    ) async throws -> AttentionMarketAd? {\n        let url = URL(string: "\\(baseURL)/decide")!\n        var request = URLRequest(url: url)\n        request.httpMethod = "POST"\n        request.setValue(apiKey, forHTTPHeaderField: "X-API-Key")\n        request.setValue(agentId, forHTTPHeaderField: "X-Agent-ID")\n        request.setValue("application/json", forHTTPHeaderField: "Content-Type")\n\n        let payload = [\n            "user_message": userMessage,\n            "conversation_history": conversationHistory ?? [],\n            "placement": placement,\n            "session_context": [\n                "device_type": "mobile",\n                "platform": "ios"\n            ]\n        ] as [String: Any]\n\n        request.httpBody = try JSONSerialization.data(withJSONObject: payload)\n\n        let (data, response) = try await session.data(for: request)\n\n        guard let httpResponse = response as? HTTPURLResponse else {\n            throw AttentionMarketError.invalidResponse\n        }\n\n        if httpResponse.statusCode == 204 {\n            return nil // No ads available\n        }\n\n        guard httpResponse.statusCode == 200 else {\n            throw AttentionMarketError.httpError(httpResponse.statusCode)\n        }\n\n        let decoder = JSONDecoder()\n        let result = try decoder.decode(DecideResponse.self, from: data)\n        return result.ad\n    }\n\n    func trackClick(trackingToken: String) async throws {\n        let url = URL(string: "\\(baseURL)/track/click")!\n        var request = URLRequest(url: url)\n        request.httpMethod = "POST"\n        request.setValue(apiKey, forHTTPHeaderField: "X-API-Key")\n        request.setValue(agentId, forHTTPHeaderField: "X-Agent-ID")\n        request.setValue("application/json", forHTTPHeaderField: "Content-Type")\n\n        let payload = ["tracking_token": trackingToken]\n        request.httpBody = try JSONEncoder().encode(payload)\n\n        let (_, response) = try await session.data(for: request)\n\n        guard let httpResponse = response as? HTTPURLResponse,\n              httpResponse.statusCode == 200 else {\n            throw AttentionMarketError.trackingFailed\n        }\n    }\n}\n\n// MARK: - Data Models\n\nstruct AttentionMarketAd: Codable {\n    let id: String\n    let type: String\n    let creative: Creative\n    let clickUrl: String\n    let directUrl: String\n    let trackingToken: String\n    let payout: Int\n    let disclosure: Disclosure\n\n    struct Creative: Codable {\n        let title: String\n        let body: String\n        let cta: String\n        let teaser: String?\n        let promoCode: String?\n\n        enum CodingKeys: String, CodingKey {\n            case title, body, cta, teaser\n            case promoCode = "promo_code"\n        }\n    }\n\n    struct Disclosure: Codable {\n        let sponsorName: String\n        let isSponsored: Bool\n\n        enum CodingKeys: String, CodingKey {\n            case sponsorName = "sponsor_name"\n            case isSponsored = "is_sponsored"\n        }\n    }\n\n    enum CodingKeys: String, CodingKey {\n        case id, type, creative, payout, disclosure\n        case clickUrl = "click_url"\n        case directUrl = "direct_url"\n        case trackingToken = "tracking_token"\n    }\n}\n\nstruct DecideResponse: Codable {\n    let ad: AttentionMarketAd?\n}\n\nenum AttentionMarketError: Error {\n    case invalidResponse\n    case httpError(Int)\n    case trackingFailed\n    case noAdsAvailable\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"swiftui-ad-component",children:"SwiftUI Ad Component"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",metastring:'title="SponsoredContentView.swift"',children:'import SwiftUI\nimport SafariServices\n\nstruct SponsoredContentView: View {\n    let ad: AttentionMarketAd\n    @State private var showingSafari = false\n    @Environment(\\.colorScheme) var colorScheme\n\n    var body: some View {\n        VStack(alignment: .leading, spacing: 12) {\n            // Sponsored label\n            HStack {\n                Image(systemName: "megaphone.fill")\n                    .foregroundColor(.secondary)\n                    .font(.caption)\n                Text("Sponsored")\n                    .font(.caption)\n                    .foregroundColor(.secondary)\n                Spacer()\n                Text(ad.disclosure.sponsorName)\n                    .font(.caption2)\n                    .foregroundColor(.secondary)\n            }\n\n            // Content\n            VStack(alignment: .leading, spacing: 8) {\n                Text(ad.creative.title)\n                    .font(.headline)\n                    .foregroundColor(.primary)\n\n                Text(ad.creative.body)\n                    .font(.subheadline)\n                    .foregroundColor(.secondary)\n                    .lineLimit(3)\n\n                // CTA Button\n                Button(action: handleClick) {\n                    HStack {\n                        Text(ad.creative.cta)\n                            .font(.callout)\n                            .fontWeight(.medium)\n                        Image(systemName: "arrow.right.circle.fill")\n                    }\n                    .padding(.horizontal, 16)\n                    .padding(.vertical, 8)\n                    .background(Color.accentColor)\n                    .foregroundColor(.white)\n                    .cornerRadius(8)\n                }\n            }\n        }\n        .padding()\n        .background(\n            RoundedRectangle(cornerRadius: 12)\n                .fill(colorScheme == .dark ? Color.gray.opacity(0.1) : Color.gray.opacity(0.05))\n                .overlay(\n                    RoundedRectangle(cornerRadius: 12)\n                        .stroke(Color.gray.opacity(0.2), lineWidth: 1)\n                )\n        )\n        .sheet(isPresented: $showingSafari) {\n            SafariView(url: URL(string: ad.clickUrl)!)\n        }\n    }\n\n    private func handleClick() {\n        // Track click analytics\n        Task {\n            try? await AttentionMarketClient.shared.trackClick(\n                trackingToken: ad.trackingToken\n            )\n        }\n\n        // Open in Safari\n        showingSafari = true\n    }\n}\n\n// Safari View Controller wrapper\nstruct SafariView: UIViewControllerRepresentable {\n    let url: URL\n\n    func makeUIViewController(context: Context) -> SFSafariViewController {\n        return SFSafariViewController(url: url)\n    }\n\n    func updateUIViewController(_ uiViewController: SFSafariViewController, context: Context) {}\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"uikit-ad-component",children:"UIKit Ad Component"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",metastring:'title="SponsoredContentViewController.swift"',children:'import UIKit\nimport SafariServices\n\nclass SponsoredContentView: UIView {\n    private let ad: AttentionMarketAd\n    private weak var parentViewController: UIViewController?\n\n    init(ad: AttentionMarketAd, parentViewController: UIViewController) {\n        self.ad = ad\n        self.parentViewController = parentViewController\n        super.init(frame: .zero)\n        setupView()\n    }\n\n    required init?(coder: NSCoder) {\n        fatalError("init(coder:) has not been implemented")\n    }\n\n    private func setupView() {\n        // Container setup\n        backgroundColor = UIColor.systemGray6\n        layer.cornerRadius = 12\n        layer.borderWidth = 1\n        layer.borderColor = UIColor.systemGray4.cgColor\n\n        // Stack view for content\n        let stackView = UIStackView()\n        stackView.axis = .vertical\n        stackView.spacing = 12\n        stackView.translatesAutoresizingMaskIntoConstraints = false\n        addSubview(stackView)\n\n        // Sponsored label\n        let sponsoredLabel = UILabel()\n        sponsoredLabel.text = "Sponsored by \\(ad.disclosure.sponsorName)"\n        sponsoredLabel.font = .preferredFont(forTextStyle: .caption1)\n        sponsoredLabel.textColor = .secondaryLabel\n        stackView.addArrangedSubview(sponsoredLabel)\n\n        // Title\n        let titleLabel = UILabel()\n        titleLabel.text = ad.creative.title\n        titleLabel.font = .preferredFont(forTextStyle: .headline)\n        titleLabel.numberOfLines = 2\n        stackView.addArrangedSubview(titleLabel)\n\n        // Body\n        let bodyLabel = UILabel()\n        bodyLabel.text = ad.creative.body\n        bodyLabel.font = .preferredFont(forTextStyle: .subheadline)\n        bodyLabel.textColor = .secondaryLabel\n        bodyLabel.numberOfLines = 3\n        stackView.addArrangedSubview(bodyLabel)\n\n        // CTA Button\n        let ctaButton = UIButton(type: .system)\n        ctaButton.setTitle(ad.creative.cta, for: .normal)\n        ctaButton.titleLabel?.font = .preferredFont(forTextStyle: .callout)\n        ctaButton.backgroundColor = .systemBlue\n        ctaButton.setTitleColor(.white, for: .normal)\n        ctaButton.layer.cornerRadius = 8\n        ctaButton.contentEdgeInsets = UIEdgeInsets(top: 8, left: 16, bottom: 8, right: 16)\n        ctaButton.addTarget(self, action: #selector(handleClick), for: .touchUpInside)\n        stackView.addArrangedSubview(ctaButton)\n\n        // Constraints\n        NSLayoutConstraint.activate([\n            stackView.topAnchor.constraint(equalTo: topAnchor, constant: 16),\n            stackView.leadingAnchor.constraint(equalTo: leadingAnchor, constant: 16),\n            stackView.trailingAnchor.constraint(equalTo: trailingAnchor, constant: -16),\n            stackView.bottomAnchor.constraint(equalTo: bottomAnchor, constant: -16)\n        ])\n    }\n\n    @objc private func handleClick() {\n        // Track click\n        Task {\n            try? await AttentionMarketClient.shared.trackClick(\n                trackingToken: ad.trackingToken\n            )\n        }\n\n        // Open in Safari\n        if let url = URL(string: ad.clickUrl) {\n            let safari = SFSafariViewController(url: url)\n            parentViewController?.present(safari, animated: true)\n        }\n    }\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"integration-in-chat-view",children:"Integration in Chat View"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",metastring:'title="ChatViewController.swift"',children:'class ChatViewController: UIViewController {\n    private let client = AttentionMarketClient(\n        apiKey: ProcessInfo.processInfo.environment["AM_API_KEY"] ?? "",\n        agentId: ProcessInfo.processInfo.environment["AM_AGENT_ID"] ?? ""\n    )\n\n    private var messageHistory: [String] = []\n    private var messageCount = 0\n    private var lastAdShownAt = 0\n\n    func handleUserMessage(_ message: String) {\n        messageCount += 1\n        messageHistory.append(message)\n\n        // Generate AI response\n        let aiResponse = generateAIResponse(for: message)\n        displayMessage(aiResponse, isUser: false)\n\n        // Check if we should show an ad\n        if shouldShowAd() {\n            Task {\n                await showContextualAd(for: message)\n            }\n        }\n    }\n\n    private func shouldShowAd() -> Bool {\n        // Placement rules\n        let minMessagesBetweenAds = 5\n        let minMessagesBeforeFirstAd = 3\n\n        guard messageCount >= minMessagesBeforeFirstAd else { return false }\n        guard messageCount - lastAdShownAt >= minMessagesBetweenAds else { return false }\n\n        return true\n    }\n\n    @MainActor\n    private func showContextualAd(for message: String) async {\n        do {\n            // Get the last 10 messages for context\n            let recentHistory = Array(messageHistory.suffix(10))\n\n            let ad = try await client.getAd(\n                userMessage: message,\n                conversationHistory: recentHistory,\n                placement: "sponsored_suggestion"\n            )\n\n            if let ad = ad {\n                // Create and display ad view\n                let adView = SponsoredContentView(ad: ad, parentViewController: self)\n                chatStackView.addArrangedSubview(adView)\n\n                // Update tracking\n                lastAdShownAt = messageCount\n\n                // Animate appearance\n                adView.alpha = 0\n                UIView.animate(withDuration: 0.3) {\n                    adView.alpha = 1\n                }\n            }\n        } catch {\n            print("Failed to load ad: \\(error)")\n            // Continue without ad - don\'t disrupt user experience\n        }\n    }\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"android-integration-kotlin",children:"Android Integration (Kotlin)"}),"\n",(0,a.jsx)(n.h3,{id:"installation-1",children:"Installation"}),"\n",(0,a.jsxs)(n.p,{children:["Add to your module's ",(0,a.jsx)(n.code,{children:"build.gradle"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-kotlin",metastring:'title="AttentionMarketClient.kt"',children:'import kotlinx.coroutines.*\nimport okhttp3.*\nimport okhttp3.MediaType.Companion.toMediaType\nimport okhttp3.RequestBody.Companion.toRequestBody\nimport org.json.JSONArray\nimport org.json.JSONObject\nimport java.io.IOException\n\nclass AttentionMarketClient(\n    private val apiKey: String,\n    private val agentId: String\n) {\n    private val baseUrl = "https://api.attentionmarket.ai/v1"\n    private val client = OkHttpClient.Builder()\n        .connectTimeout(10, TimeUnit.SECONDS)\n        .readTimeout(10, TimeUnit.SECONDS)\n        .build()\n\n    private val json = "application/json".toMediaType()\n\n    suspend fun getAd(\n        userMessage: String,\n        conversationHistory: List<String>? = null,\n        placement: String = "sponsored_suggestion"\n    ): AttentionMarketAd? = withContext(Dispatchers.IO) {\n        val payload = JSONObject().apply {\n            put("user_message", userMessage)\n            put("conversation_history", JSONArray(conversationHistory ?: emptyList()))\n            put("placement", placement)\n            put("session_context", JSONObject().apply {\n                put("device_type", "mobile")\n                put("platform", "android")\n            })\n        }\n\n        val request = Request.Builder()\n            .url("$baseUrl/decide")\n            .post(payload.toString().toRequestBody(json))\n            .addHeader("X-API-Key", apiKey)\n            .addHeader("X-Agent-ID", agentId)\n            .addHeader("Content-Type", "application/json")\n            .build()\n\n        try {\n            client.newCall(request).execute().use { response ->\n                when (response.code) {\n                    200 -> {\n                        val body = response.body?.string() ?: return@withContext null\n                        parseAdResponse(body)\n                    }\n                    204 -> null // No ads available\n                    else -> throw IOException("HTTP ${response.code}")\n                }\n            }\n        } catch (e: Exception) {\n            e.printStackTrace()\n            null\n        }\n    }\n\n    suspend fun trackClick(trackingToken: String) = withContext(Dispatchers.IO) {\n        val payload = JSONObject().apply {\n            put("tracking_token", trackingToken)\n        }\n\n        val request = Request.Builder()\n            .url("$baseUrl/track/click")\n            .post(payload.toString().toRequestBody(json))\n            .addHeader("X-API-Key", apiKey)\n            .addHeader("X-Agent-ID", agentId)\n            .build()\n\n        try {\n            client.newCall(request).execute().close()\n        } catch (e: Exception) {\n            e.printStackTrace()\n        }\n    }\n\n    private fun parseAdResponse(json: String): AttentionMarketAd? {\n        return try {\n            val response = JSONObject(json)\n            val adJson = response.optJSONObject("ad") ?: return null\n\n            AttentionMarketAd(\n                id = adJson.getString("id"),\n                type = adJson.getString("type"),\n                creative = AttentionMarketAd.Creative(\n                    title = adJson.getJSONObject("creative").getString("title"),\n                    body = adJson.getJSONObject("creative").getString("body"),\n                    cta = adJson.getJSONObject("creative").getString("cta"),\n                    teaser = adJson.getJSONObject("creative").optString("teaser"),\n                    promoCode = adJson.getJSONObject("creative").optString("promo_code")\n                ),\n                clickUrl = adJson.getString("click_url"),\n                directUrl = adJson.getString("direct_url"),\n                trackingToken = adJson.getString("tracking_token"),\n                payout = adJson.getInt("payout"),\n                disclosure = AttentionMarketAd.Disclosure(\n                    sponsorName = adJson.getJSONObject("disclosure").getString("sponsor_name"),\n                    isSponsored = adJson.getJSONObject("disclosure").getBoolean("is_sponsored")\n                )\n            )\n        } catch (e: Exception) {\n            e.printStackTrace()\n            null\n        }\n    }\n}\n\n// Data Models\ndata class AttentionMarketAd(\n    val id: String,\n    val type: String,\n    val creative: Creative,\n    val clickUrl: String,\n    val directUrl: String,\n    val trackingToken: String,\n    val payout: Int,\n    val disclosure: Disclosure\n) {\n    data class Creative(\n        val title: String,\n        val body: String,\n        val cta: String,\n        val teaser: String? = null,\n        val promoCode: String? = null\n    )\n\n    data class Disclosure(\n        val sponsorName: String,\n        val isSponsored: Boolean\n    )\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"jetpack-compose-ad-component",children:"Jetpack Compose Ad Component"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-kotlin",metastring:'title="SponsoredContent.kt"',children:'@Composable\nfun SponsoredContent(\n    ad: AttentionMarketAd,\n    onAdClick: (AttentionMarketAd) -> Unit\n) {\n    Card(\n        modifier = Modifier\n            .fillMaxWidth()\n            .padding(horizontal = 16.dp, vertical = 8.dp),\n        shape = RoundedCornerShape(12.dp),\n        colors = CardDefaults.cardColors(\n            containerColor = MaterialTheme.colorScheme.surfaceVariant\n        )\n    ) {\n        Column(\n            modifier = Modifier.padding(16.dp)\n        ) {\n            // Sponsored label\n            Row(\n                modifier = Modifier.fillMaxWidth(),\n                horizontalArrangement = Arrangement.SpaceBetween\n            ) {\n                Row(verticalAlignment = Alignment.CenterVertically) {\n                    Icon(\n                        imageVector = Icons.Filled.Campaign,\n                        contentDescription = "Sponsored",\n                        modifier = Modifier.size(16.dp),\n                        tint = MaterialTheme.colorScheme.onSurfaceVariant\n                    )\n                    Spacer(modifier = Modifier.width(4.dp))\n                    Text(\n                        text = "Sponsored",\n                        style = MaterialTheme.typography.labelSmall,\n                        color = MaterialTheme.colorScheme.onSurfaceVariant\n                    )\n                }\n                Text(\n                    text = ad.disclosure.sponsorName,\n                    style = MaterialTheme.typography.labelSmall,\n                    color = MaterialTheme.colorScheme.onSurfaceVariant\n                )\n            }\n\n            Spacer(modifier = Modifier.height(12.dp))\n\n            // Title\n            Text(\n                text = ad.creative.title,\n                style = MaterialTheme.typography.titleMedium,\n                fontWeight = FontWeight.Bold\n            )\n\n            Spacer(modifier = Modifier.height(8.dp))\n\n            // Body\n            Text(\n                text = ad.creative.body,\n                style = MaterialTheme.typography.bodyMedium,\n                color = MaterialTheme.colorScheme.onSurfaceVariant,\n                maxLines = 3,\n                overflow = TextOverflow.Ellipsis\n            )\n\n            Spacer(modifier = Modifier.height(12.dp))\n\n            // CTA Button\n            Button(\n                onClick = { onAdClick(ad) },\n                modifier = Modifier.align(Alignment.End),\n                colors = ButtonDefaults.buttonColors(\n                    containerColor = MaterialTheme.colorScheme.primary\n                )\n            ) {\n                Text(text = ad.creative.cta)\n                Spacer(modifier = Modifier.width(4.dp))\n                Icon(\n                    imageVector = Icons.Default.ArrowForward,\n                    contentDescription = null,\n                    modifier = Modifier.size(18.dp)\n                )\n            }\n        }\n    }\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"contextual-placement-strategy",children:"Contextual Placement Strategy"}),"\n",(0,a.jsx)(n.h3,{id:"smart-placement-rules",children:"Smart Placement Rules"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-kotlin",children:'class AdPlacementManager {\n    private var messageCount = 0\n    private var lastAdShownAt = 0\n    private var sessionStartTime = System.currentTimeMillis()\n\n    fun shouldShowAd(\n        userMessage: String,\n        aiResponse: String\n    ): Boolean {\n        messageCount++\n\n        // Rule 1: Don\'t show ads too early\n        if (messageCount < MIN_MESSAGES_BEFORE_FIRST_AD) return false\n\n        // Rule 2: Space out ads appropriately\n        if (messageCount - lastAdShownAt < MIN_MESSAGES_BETWEEN_ADS) return false\n\n        // Rule 3: Don\'t show during onboarding (first 30 seconds)\n        if (System.currentTimeMillis() - sessionStartTime < 30000) return false\n\n        // Rule 4: Check for commercial intent\n        val hasCommercialIntent = detectCommercialIntent(userMessage)\n\n        // Rule 5: Good placement opportunity (after providing value)\n        val providedValue = aiResponse.length > 100 ||\n                           aiResponse.contains("Here") ||\n                           aiResponse.contains("I found")\n\n        return hasCommercialIntent || (providedValue && Random.nextFloat() < 0.3f)\n    }\n\n    private fun detectCommercialIntent(message: String): Boolean {\n        val commercialKeywords = listOf(\n            "buy", "purchase", "need", "looking for", "recommend",\n            "best", "compare", "price", "cost", "cheap", "affordable"\n        )\n\n        return commercialKeywords.any {\n            message.lowercase().contains(it)\n        }\n    }\n\n    fun recordAdShown() {\n        lastAdShownAt = messageCount\n    }\n\n    companion object {\n        const val MIN_MESSAGES_BEFORE_FIRST_AD = 3\n        const val MIN_MESSAGES_BETWEEN_ADS = 5\n    }\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"performance--optimization",children:"Performance & Optimization"}),"\n",(0,a.jsx)(n.h3,{id:"caching-strategy",children:"Caching Strategy"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",children:'// iOS - URLSession caching\nlet config = URLSessionConfiguration.default\nconfig.requestCachePolicy = .returnCacheDataElseLoad\nconfig.urlCache = URLCache(\n    memoryCapacity: 10 * 1024 * 1024,  // 10 MB\n    diskCapacity: 50 * 1024 * 1024,    // 50 MB\n    diskPath: "attentionmarket_cache"\n)\n'})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-kotlin",children:'// Android - OkHttp caching\nval cacheSize = 10L * 1024L * 1024L // 10 MB\nval cache = Cache(context.cacheDir, cacheSize)\n\nval client = OkHttpClient.Builder()\n    .cache(cache)\n    .addInterceptor { chain ->\n        val request = chain.request().newBuilder()\n            .header("Cache-Control", "max-age=60") // Cache for 60 seconds\n            .build()\n        chain.proceed(request)\n    }\n    .build()\n'})}),"\n",(0,a.jsx)(n.h3,{id:"battery--data-optimization",children:"Battery & Data Optimization"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Batch requests"})," when multiple ads needed"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Cache responses"})," for 60 seconds minimum"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Respect network conditions"})," - reduce requests on cellular"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Background prefetch"})," during Wi-Fi for better UX"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"app-store--play-store-compliance",children:"App Store & Play Store Compliance"}),"\n",(0,a.jsx)(n.h3,{id:"required-disclosures",children:"Required Disclosures"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Privacy Policy"})," must mention:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Contextual advertising"}),"\n",(0,a.jsx)(n.li,{children:"No user tracking"}),"\n",(0,a.jsx)(n.li,{children:"Data used only for ad selection"}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"App Store Review Notes"}),":"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:'Ads are clearly labeled as "Sponsored"'}),"\n",(0,a.jsx)(n.li,{children:"No incentivized clicks"}),"\n",(0,a.jsx)(n.li,{children:"Compliant with Apple's advertising guidelines"}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Google Play Requirements"}),":"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Declare ad ID usage (not required for contextual)"}),"\n",(0,a.jsx)(n.li,{children:"Family-safe ads if in family category"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"testing",children:"Testing"}),"\n",(0,a.jsx)(n.h3,{id:"test-credentials",children:"Test Credentials"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"# Use these for development\nAPI_KEY: am_test_abc123xyz\nAGENT_ID: agt_test_demo\n"})}),"\n",(0,a.jsx)(n.h3,{id:"test-scenarios",children:"Test Scenarios"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",children:'// iOS Testing\n#if DEBUG\nclass MockAttentionMarketClient: AttentionMarketClient {\n    override func getAd(...) async throws -> AttentionMarketAd? {\n        // Return mock ad for testing\n        return AttentionMarketAd(\n            id: "test_ad",\n            creative: .init(\n                title: "Test Product",\n                body: "Great for testing",\n                cta: "Learn More"\n            ),\n            // ... other fields\n        )\n    }\n}\n#endif\n'})}),"\n",(0,a.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,a.jsx)(n.h3,{id:"common-issues",children:"Common Issues"}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Issue"}),(0,a.jsx)(n.th,{children:"Solution"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"No ads returned"}),(0,a.jsx)(n.td,{children:"Normal - no relevant campaigns. Implement graceful fallback"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"401 Unauthorized"}),(0,a.jsx)(n.td,{children:"Check API key and Agent ID headers"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"Network timeouts"}),(0,a.jsx)(n.td,{children:"Implement retry with exponential backoff"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"UI not updating"}),(0,a.jsx)(n.td,{children:"Ensure UI updates on main thread"})]})]})]}),"\n",(0,a.jsx)(n.h2,{id:"support",children:"Support"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Mobile SDK Beta"}),": Join waitlist at ",(0,a.jsx)(n.a,{href:"https://attentionmarket.ai/mobile-sdk",children:"attentionmarket.ai/mobile-sdk"})]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Discord"}),": ",(0,a.jsx)(n.a,{href:"https://discord.gg/attentionmarket",children:"Mobile developers channel"})]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Sample Apps"}),": ",(0,a.jsx)(n.a,{href:"https://github.com/attentionmarket/ios-example",children:"GitHub - iOS"})," | ",(0,a.jsx)(n.a,{href:"https://github.com/attentionmarket/android-example",children:"Android"})]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},8453(e,n,t){t.d(n,{R:()=>o,x:()=>s});var i=t(6540);const a={},r=i.createContext(a);function o(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);